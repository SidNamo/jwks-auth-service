<!-- templates/header.html -->

<div class="flex items-center justify-between w-full">
    <!-- 중앙 제목 -->
    <div class="flex-1 text-center text-lg font-semibold text-white tracking-tight">
        통합 인증 센터
    </div>

    <!-- 우측 사용자 드롭다운 -->
    {% if request.state.user %}
    <div class="relative ml-auto">
        <button id="user-menu-button"
            class="flex items-center gap-2 bg-gray-700 hover:bg-gray-600 px-3 py-1.5 rounded-md text-sm font-medium shadow transition">
            <span>{{ request.state.user.name }}</span>
            <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 text-gray-200" fill="none" viewBox="0 0 24 24"
                stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
            </svg>
        </button>

        <!-- ✅ 드롭다운 표시 수정 -->
        <div id="user-dropdown"
            class="hidden absolute right-0 mt-2 w-48 bg-[#141316] text-gray-200 border border-gray-700 rounded-xl shadow-2xl overflow-hidden z-50">
            <a href="{{ request.base_url }}user/mypage"
                class="block px-4 py-2.5 hover:bg-purple-700/40 transition flex items-center justify-between">
                <span>마이페이지</span>
                <i data-lucide="user" class="w-4 h-4 text-gray-400"></i>
            </a>
            <a href="{{ request.base_url }}user/signout"
                class="block px-4 py-2.5 hover:bg-purple-700/40 transition flex items-center justify-between">
                <span>로그아웃</span>
                <i data-lucide="log-out" class="w-4 h-4 text-gray-400"></i>
            </a>
        </div>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const btn = document.getElementById("user-menu-button");
            const dropdown = document.getElementById("user-dropdown");

            if (btn && dropdown) {
                btn.addEventListener("click", (e) => {
                    e.stopPropagation();
                    dropdown.classList.toggle("hidden");
                });

                document.addEventListener("click", (e) => {
                    if (!dropdown.contains(e.target) && !btn.contains(e.target)) {
                        dropdown.classList.add("hidden");
                    }
                });
            }
        });
    </script>
    {% else %}
    <!-- ✅ 비로그인 상태 -->
    <div class="flex items-center gap-3 ml-auto">
        <a href="{{ request.base_url }}user/signin"
            class="bg-gray-700 hover:bg-gray-600 text-gray-100 px-4 py-1.5 rounded-md text-sm font-medium shadow transition">
            <span>로그인</span>
        </a>
        <a href="{{ request.base_url }}user/signup"
            class="bg-purple-600 hover:bg-purple-500 text-white px-4 py-1.5 rounded-md text-sm font-medium shadow transition">
            <span>회원가입</span>
        </a>
    </div>
    {% endif %}
</div>